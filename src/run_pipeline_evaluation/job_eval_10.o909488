1) Read ens redundant annotations
Number of gene 1334
2) Read MGI similarity...
3) Read Score for pair with MGI Score...
Number of gene pairs 521587
4) Sort pair according Score...
Number of Pair 521587
5) read and look at distribution mgi/hpo...
> args <- commandArgs(trailingOnly = TRUE)
> print(args)
[1] "/net/isi-scratch/cynthia/CW007_SANDOR_Pipeline/network/all/goa_cc_resg_av_ordered_filter_4.0_sort.eval"                            
[2] "0.11"                                                                                                                              
[3] "/net/isi-backup/webber/code/cynthias/disease_specific_network_v4/data/frankdatasetnorm/gocc/goa_cc_resg_av_ordered_filter_4.0_sort"
[4] "/net/isi-scratch/cynthia/CW007_SANDOR_Pipeline/network/all/goa_cc_resg_av_ordered_filter_4.0_sort.rescore"                         
[5] "/net/isi-scratch/cynthia/CW007_SANDOR_Pipeline/network/all/goa_cc_resg_av_ordered_filter_4.0_sort.eval.png"                        
> 
> 
> # parameters
> f_measure_mgi <-args[1]
> random_val <- as.numeric(args[2])
> f_pair_gene<-args[3]
> f_pair_gene_rescale<-args[4]
> f_graphe_report<-args[5]
> 
> 
> # read data 
> data<-read.table(f_measure_mgi)
> x<-data$V1
> y<-data$V2
> 
> 
> 
> # get intercept
> intercept<-intersection(x,y,index,min(x),max(x),random_val)
> intercept
[1] 0.0001503234
> 
> # get informative
> datasub <- subset(data, data$V1 > intercept)
> xsub<-datasub$V1
> ysub<-datasub$V2
> 
> # multivariate adaptive regression splines
> model_earth<-earth(xsub,ysub) 
> coefficient<-coef(summary(model_earth))
> coefficient
      (Intercept) h(xsub-0.0435145) h(0.0435145-xsub)   h(xsub-0.19948) 
       0.09986427        0.87773661        0.24847350        0.41441866 
h(xsub-0.0582853) h(xsub-0.0782569)  h(xsub-0.176121) 
      -1.31765774        0.59267053       -0.24493852 
> for (i in 2:length(coefficient)){
+ 	if (coefficient[i] < -0.1) {
+ 		model_earth<-earth(xsub,ysub,linpreds=1)
+ 		break
+ 	}
+ }
> summary(model_earth)
Call: earth(x=xsub, y=ysub, linpreds=1)

            coefficients
(Intercept)   0.09964841
xsub          0.10986493

Selected 2 of 2 terms, and 1 of 1 predictors
Termination condition: RSq changed by less than 0.001 at 2 terms
Importance: xsub
Number of terms at each degree of interaction: 1 1 (additive model)
GCV 7.845392e-05    RSS 0.08127894    GRSq 0.2791236    RSq 0.2818909
> 
> # apply this model full data
> data_full<-read.table(f_pair_gene)
> data_full_sub <- subset(data_full, data_full$V3 > intercept)
> ypredict<-predict(model_earth,newdata = data.frame(data_full_sub$V3))
> data_new<-data.frame(data_full_sub$V1,data_full_sub$V2,ypredict)
> write.table(data_new, file = f_pair_gene_rescale, sep = "\t",quote=FALSE,row.names = FALSE,col.names=FALSE)
> 
> # plot rescale
> png(filename =f_graphe_report, width = 480, height = 480,pointsize = 12, bg = "white")
> plot(x,y,xlab='',ylab='',main='')
> x_plot<-seq(intercept,1, length = 200)
> y_plot<-predict(model_earth,newdata = data.frame(x_plot))
> points(x_plot,y_plot,col='blue')
> abline(v=intercept,col='blue')
> 
> 
> abline(h=random_val,col='gray',lty=2,lwd=2)
> dev.off()
null device 
          1 
> 
> 
create bin genomic measure vs phenotypic benchmark...
evaluation and rescore of dataset...
